### VIM

##### normal模式
J: 合并两行  
u: 撤销  
U: 撤销对整行的全部操作  
Ctrl+r: 重做,对撤销的撤销  
ZZ: 保存退出  
Ctrl+]: 跳至标签  
Ctrl+t,Ctrl+o: 跳回之前的位置  

##### 移动光标
w: 光标移至下一个单词首字符 （backward）  
W: 光标后移至词首，以空格为分隔符  
b: 光标移至上一个单词首字符 （end od word）  
B: 光标前移至词首，以空格为分隔符  
e: 光标移至下一个单词尾字符  
E: 光标后移至词尾，以空格为分隔符  
ge: 光标移至上一个单词尾字符  

$: 光标移至当前行尾  
n$: 光标移至下n-1行行尾  
^: 光标移至当前行首  
0: 光标移至绝对行首  

fx: 查找下一个x字符  
nfx: 查找下n个x字符  
Fx: 向前搜索x字符  

tx/Tx: 同fx但将光标停留在x字符前一个字符上  

%: 跳转至与当前光标下括号相匹配的括号上  
n%: 跳转至%n行  
nG: 跳转至第n行  

\`\`: 当使用`G`命令跳转时，vim会标记起跳的位置，\`\`命令可以跳回，再次使用这个命令又会跳转回去，\`\`命令可以在两点之间来回跳转    
Ctrl+o:跳转到更早些时间停置光标的位置    
Ctrl+i:跳转到后来停置光标的更新位置，同`Tab`键   
:jumps :可以列出曾经跳转列表  

###### 屏幕范围跳转
H: 跳转至当前屏幕首行  
M: 跳转至当前屏幕中间  
L: 跳转至当前屏幕末行 

###### 滚屏
Ctrl+u: 光标向上滚动半屏  
Ctrl+d: 光标向下滚动半屏  

Ctrl+f: 向前滚动一屏 forward  
Ctrl+b: 向后滚动一屏 backward  

zz: 把当前行置于屏幕中间   
zt: 把当前行置于屏幕顶端 top  
zb: 把当前行至于屏幕底端 bottom 

###### 具名标记
mx: 设置具名标记，可以a-z自定义标记，使用\`x跳转至标记所在位置，'x可以跳转至标记所在行行首   
:marks :可以查看标记列表  
': 进行此次跳转之前的起跳点  
": 上次编辑该文件时光标最后停留的位置  
\[: 最后一次修改的起始位置  
\]: 最后一次修改的结束位置  
 
###### 显示当前位置
Ctrl+g  
:set num  
:set ruler  

###### 查找WORD
将光标放在`WORD`上，按`*`向下搜索，按`#`向上搜索  
/\<WORD\>查找WORD 

###### 替换
r: 替换单个字符
.: 重复上一次做出的改动
~: 改变当前光标下字符大小写，并将光标移至下一个字符

##### 查找替换
:[range]s/form/to/[flag] 
```
[range] : 
1. 不指定一个范围的话，":s"将只作用于当前行;
2. "%"指定该命令将作用于所有行上;
3. 两个以数字表示的行号, ":1,5s/this/that/g";
4. 单个的数字指示命令将只作用于由该数字指定的行上;
5. 可以使用一个搜索模式指定作用范围；
   :?^Chapter?,/^Chapter/s=grey=gray=g
   第一个"?^Chapter?"向后查找，"/^Chapter/"向前查找。 
6. 作用范围的上下偏移，":.+3,$-5",从当前行其下的第3行开始，到倒数第6
7. 使用标记，如用"mt"来标记一个范围的开始，"mb"标记它的结束。然后就可以这样指定这个范围:(包括标记本身所在的行)：":'t,'b"
8. visual模式范围： 如果你在Visual模式下选定了文本后按下了":"，你将会看到如下命令：":'<,'>"
   '<和'>实际上就是标记，分别代表一个Visual选择区域的开始和结束。退出Visual模式后这两个标记仍然保持，直到下一次进入Visual模式。所以你还可用"'<"命令来跳转到你一次在Visual模式时选定的文本区域的开始处。
9. 以数字指定行数,如果你已经知道要使命令作用于几行内容，可以直接按下这个数字，然后按":"。比如，按下"5:",它表示":.,.+4"

[flag]:
1. 默认情况下，":substitute"命令只会替换一行中第一次被发现的目标字符串;
2. 改变一行中所有符合的目标字符串，可以在命令后加"g"标志加以修饰;
3. c(确认)标志告诉":substitute"命令要在执行每个替换前请求用户确认;
    Vim会在找到第一个"Professor"后显示下面的信息并要求你的回答：
    replace with Teacher (y/n/a/q/l/^E/^Y)?
    y 好吧， 替换吧
    n 不， 这个先留着
    a 别问了， 全部换掉吧(这群教授都不够格?? :-) )
    q 退出， 剩下的也不要管了
    l 把现在这个改完就退出吧
    CTRL-E 向上滚屏一行
    CTRL-Y 向下滚屏一行
4. e标志告诉":substitute"命令就算没找到一个匹配的目标你也不要报错。
```

```
Doe, John
Smith, Peter
替换为：
John Doe
Peter Smith

:%s/\([^,]*\), \(.*\)/\2 \1/
匹配除逗号外的任何东西 [^,]
任意次重复 *
任意字符 .

"\2"和"\1"在Vim中被称作反向引用。它们可以用来指代此前在\( \)中匹配的内容。 "\2"指代在第二个"\(\)"中匹配的内容，你可以使用多达9个的反向引用。 "\0"特指整个匹配到内容。
```

##### 执行shell命令
:!command 不退出vim，并执行shell命令command，将命令输出显示在vim的命令区域，不会改变当前编辑的文件的内容  
:r !command 将shell命令command的结果插入到当前行的下一行  
:起始行号,结束行号 !command 将起始行号和结束行号指定的范围中的内容输入到shell命令command处理，并将处理结果替换起始行号和结束行号指定的范围中的内容  
  例如：`:% !sort` 排序当前编辑的文件  

:起始行号,结束行号 w !command 将起始行号和结束行号所指定的范围的内容作为命令command的输入。不会改变当前编辑的文件的内容  
特殊用法 `:62 w !bash`，将会把第62行的内容作为bash命令来执行并显示结果，而且不会改变当前编辑的文件的内容  

##### 替换多个文件中的内容
假设你有一个目录下有很多C++文件，都以".cpp"为扩展名。现欲将所有名为"GetResp"的函数更名为"GetAnswer".
vim *.cpp   启动Vim，同时指定了要编辑的文件列表：所有的C++文件。现在你正在编辑的将是第一个文件。
qq          开始宏记录，将后续的操作记录在名为q的宏中。
:%s/\<GetResp\>/GetAnswer/g    在第一个文件中执行替换操作。
:wnext      保存该文件并转到下一个文件进行编辑
q           停止宏记录
@q          执行名为q的宏。它将执行前面记录的替换操作和":wnext。你可以看看整个过程有没有什么错误。
999@q       对其余文件执行同样的操作

回放一个宏记录时，任何错误都会导致整个宏记录停止执行。
还有一种例外：如果其中一个.cpp文件中连一个"GetResp"都没有，替换操作会引起一个错误，整个宏的执行也会被停下来。标志"e"正是致力于消除这一副作用：
:%s/\<GetResp\>/GetAnswer/ge
"e"标志告诉":substitute"命令就算没找到一个匹配的目标你也不要报错。

##### 消除多余的空格
:%s/\s\+$//

##### 全局命令
:[range]global/{pattern}/{command} ： 它允许你找到符合某个匹配模式的行然后将命令作用其上。
":global"中所谓的命令都必需是以":"开始的命令行命令，Normal模式下的命令不能直接使用。 
:g+//+s/foobar/barfoo/g ：该命令以":g"开始，接下来是以加号分隔的搜索模式。最后是将"foobar"替换为"barfoo"的命令。

##### 反转行序
`:global`命令可以与`:move`命令结合起来将所有行移到第一行的前面，这样的结果将是得到一个各行反序排列的文件。
:g/^/m 0  : "^"这个正则表达式匹配一行的开头(即使该行是空行也可匹配到).`:move`命令则将匹配的行移到神秘的第0行之后，所以该行会变成第一行。 `:global`命令并不会因这种行号的易序而发生错乱。它将继续处理剩余的行，并将每一行逐个放到文件的第一行去

对一串连续的行也同样可行。首先移到第一行并以"mt"标记该行。然后移到最后一行执行命令
:'t+1,.g/^/m 't

##### 统计字数
g+ctrl-g
输出：`Col 1 of 0; Line 141 of 157; Word 748 of 774; Byte 4489 of 4976`
如果你要统计整个文件的其中一部分内容，使用Visual模式，选择要统计的部分。然后用"g+ctrl-g"。

###### 小幅修改
x: 删除一个字符  
X: 删除光标左边的一个字符  
d: `d`命令后可跟任何一个位移命令，它将删除当前光标位置至位移处的文本内容，d4w, d$，dd等,  
dG：删除当前行至文件尾    
dgg: 删除当前行至文件头  
D: 同d$，删除至行尾  
c: change，与`d`命令类似，但在命令执行后进入Insert模式, `cc`，删除整行    
C: 同c$  
p: 将删除的内容取回了，`P`  
xp: 交换两个字符，x删除一个字符，并放在寄存器中，p将字符取回来放在光标之后     
y: 复制  

###### 正则匹配
^: 行首  
$: 行尾  
.: 匹配单个任意字符    

##### 虚拟模式
v：虚拟字符模式  
V: 虚拟行模式  
Ctrl+v: 虚拟块模式  
o: other end,将光标至于被选文本的另一端  
O: 当使用虚拟块模式时，`o`命令会将光标至于对角线的另一端，`O`可以在同行的两个角上移动  

对选中的区域进行操作：
```
d	删除选中文本
c	修改选中文本
r	替换选中文本
I	在选中文本前插入
A	在选中文本后插入
gu	选中区域转为小写
gU	选中区域转为大写
g~	大小写互调
>	向右缩进一个单位, 移动宽度由":set shiftwidth=4/set sw=4"指定
<	向左缩进一个单位
J 命令使文本块纵跨的所有文本行被连接为一行,如果你想保留那些前导空白和后辍空白，用"gJ"命令来代替"J"
```

##### 文本对象
不管当前光标所在的位置而把整个文本对象作为操作对象  
daw: delete a word  
cis: inner sentence, `as` a sentence    

##### 命令行模式
##### 移动光标
```
<Shift-Left> 或 <Ctrl-Left> 向左一个单词
<Shift-Right> 或 <Ctrl-Right> 向右一个单词
CTRL-b 或 <Home> 到命令行行首
CTRL-e 或 <End> 到命令行行尾  
```

##### 命令补全
制表符`Tab`键可以补全光标之后的单词，如果一个<Tab>补全的不是你想要的，那就再按一次，有多个符合的文件名时，你可以一次一个把它们都过一遍。
Vim会在整个列表中轮番循环， `CTRL-p`同`<UP>`可以反序遍历整个列表，`ctrl-n`同`<Down>`向下遍历, previous, next
Vim进行补全时考虑到了命令的上下文环境。用什么补全要依命令而定。 
有众多的补全候选项时，最好是能一次看清所有的候选：用`CTRL-d`
`CTRL-l`命令会最大限度地补全各候选项的共同部分 

##### 命令行历史记录
假设你用过一次":set"命令，接着用过10次其它的冒号命令之后又想重复这个":set"命令。你可以按下":"然后按10次上箭头键<Up>。更快的办法是：`:se<UP>`
上箭头键`<Up>`会根据目前键入的命令部分去跟历史记录进行比较。
如果没找到，你还可以用下箭头键`<Down>`回到刚才输入的部分命令进行修改。或者用`CTRL-u`命令全部删除后重来。

##### 命令行窗口
`q:` : 命令可以打开命令行窗口
回车键会执行当前行的命令
命令历史记录窗口有时十分有用，你可以在此浏览整个历史记录，找到一个相近的命令，稍加修改，然后重新执行它。也可以用搜索命令来进行查找

##### 挂起与恢复
Vim也可以用`CTRL-z`来挂起。该命令停止Vim的执行使你回到启动Vim的shell中去。你可以做些别的事。完了再用`fg`命令回到Vim

如果只执行一个shell命令的话可以在Vim中用`:!{command}`命令 ` :!ls`

##### 会话
假设你已在Vim中干了一整天了。现在想退出来第二天接着干。这时可以把目前的状态以一个会话保存起来，第二天可以据此恢复原样。
`:mksession vimbook.vim` ：创建一个会话文件
`:source vimbook.vim`: 恢复到此前的会话状态，或`vim -S vimbook.vim`

##### 模式行
编辑某个特殊文件时，你可能希望为该文件特别一些选项。如C程序中，设置缩进为4个空格。`/* vim:set shiftwidth=4: */`
把这行文本放到文件的前5行中或最后5行中。编辑该文件时，你看看'shiftwidth'选项是不是已经设置为了4。编辑其它文件时，它又会回到默认的设置:8.
`modelines`选项控制Vim前后检查多少行来找出模式行，`:set modelines=10`
模式行的格式是这样的：
```
any-text vim:set {option}={value} ... : any-text
```
其中的"any-text"是说你可以在对Vim有用的部分文本之前或之后放入任何东西。这使得模式行可以以一个注释的形式出现，比如上例中的/*和*/.

##### 文件浏览器
Vim有一个可以编辑目录的插件，可以列出当前目录下的内容，并操作。
```
:edit .
```
你可以在其中看到这样的条目：
```
1. 该文件浏览插件的名字和版本号
2. 当前正浏览的目录的名字
3. 排序的方法(可能是根据名字, 时间或大小)
4. 当按名字排序时, 分别排序不同类型文件的次序(比如先排序目录, 然后是.h文件, 接下来是*.c文
5. 如何获得帮助(使用\VimSpecialChar{F1}键), 以及命令的缩略列表.
6. 文件列表, 包括可以让你访问父目录的\VimDQuote{../}.
```
你可以在这个特殊的缓冲区中使用Normal模式下的Vim命令来移动。比如 ，将光标移到一个文件上按<Enter>。这将会打开该文件进行编辑。要回到刚才的文件浏览器再次用`:edit .`命令即可 ，或者用`:Explore`， `CTRL-o`也一样
在`../`上按下`<Enter>`则会上溯到当前目录的父目录。`-`命令也是殊途同归，而且使用`-`命令时不限于当前光标位于何处

下面的命令用于选择文件进行预览或编辑: (前提是光标位于文件名上)
```
<Enter> 在当前窗口中打开文件
t 在一个新标签页中打开文件
i 控制列表显示的风格(仅文件名, 还是在一行中显示详细信息,逐行列出项目, 还是树形显示), 其中详细信息风格包括文件大小和日期信息
s 重复按s会循环改变文件排序的方式: 按文件名排序, 按最后修改时间,或者根据文件大小.
r 切换正反向排序
c 将当前目录切换到浏览器正打开的目录
R 更改当前光标下的文件
d 创建一个目录
D 删除当前光标下的文件名
Ctrl-l  刷新目录
```

##### 编辑非文本文件
###### 格式转换
你也可以利用'fileformat'选项来转换文件的格式。假如你有一个MS-DOS格式的文件README.TXT。现在你想把它转换为UNIX格式：
```
:set fileformat=unix
:write
```

###### 加密文件
```
vim -x exam.txt
```
下次以Vim打开该文件时 ，它会提醒你输入密码。 
```
:X
```
关闭加密


##### 删除
Ctrl-w: 删除光标之前的整个单词
Ctrl-u: 删除光标之前的所有已键入的内容

##### 命令行选项
:set ignorecase :忽略大小写  
:set noignorecase  

:set hlsearch: 设置搜索高亮  
:set nohlsearch  
:nohlsearch： 仅去掉当前高亮  

:set incsearch: 增量搜索  
:set nowrapscan: 搜索至文件开头或结尾停止，不循环搜索  

:set showmode   
:set showcmd  
:set ruler  
```
+-------------------------------------------------+  
|text in the Vim window                           |  
|~                                                |  
|~                                                |  
|-- VISUAL --                         2f 43,8 17% |  
+-------------------------------------------------+  
^^^^^^^^^^^                     ^^^^^^^^ ^^^^^^^^^^  
'showmode'                      'showcmd' 'ruler'  
```

:set nowrap: 设置不折行  
:set list: 查看制表符 
:set cmdheight=3: Vim启动时会在窗口最底部留下一行用于显示信息。要显示的信息太长时，Vim或者把它截短让你只能看到部分内容，或者多出来的信息需要
你按下回车键以滚动显示。你可以设置'cmdheight'选项来控制拿出几行来显示这些信息  

###### 命令映射  
:map :设置映射，`:map <F5> i{<Esc>ea}<Esc>`  
:autocmd: 设置自动执行的命令，`autocmd FileType text setlocal textwidth=78`, "autocmd FileType text"是一个自动命令。它所定义的是每当文件类型被设置为"text"时就自动执行它后面的命令。"setlocal textwidth=78"把"textwidth"选项的值设置为78，但这种设置只对当前的一个文件有效。  

#### Plugin
###### 全局plugin
- $VIMRUNTIME/macros  /usr/share/vim/vim74/macros  
- http://www.vim.org  
将plugin放在~/.vim/plugin/目录下即可
:!mkdir ~/.vim
:!mkdir ~/.vim/plugin
:!cp $VIMRUNTIME/macros/matchit.vim ~/.vim/plugin

##### 语法高亮
:syntax enable : 打开语法高亮
在vimrc中打开，在终端支持彩色显示时才启用语法高亮  
```
if &t_Co > 1  
    syntax enable  
endif 
```

查看支持语法高亮的文本: /usr/share/vim/vim74/syntax/  

:syntax clear : 临时关闭语法高亮  
:syntax off : 停止语法高亮  

##### 编辑多个文件
:edit foo.txt : 可以在当前Vim中开始编辑另一个文件。Vim会关闭当前正在编辑的文件打开指定的新文件进行编辑。如果当前文件还有未存盘的内容，Vim会显示错误消息同时也不会打开另一个文件,此时，你可以有几种选择。`:write`保存该文件,`:edit! foo.txt`强制Vim丢弃当前未保存的修改并开始编辑新的文件,`:hide edit foo.txt`如果你想编辑另一个文件，但又不想保存当前文件中的改动，你可以使它变为一个隐藏的缓冲区  

可以在启动Vim时就指定要编辑多个文件: `vim one.c two.c three.c`,Vim将在启动后只显示第一个文件。完成该文件的编辑后，可以以命令`:next`开始下一个文件的编辑。`:wnext`保存当前工作成果并继续下一个文件的编辑；`:args`可以查看整个列表中就有哪些文件，正在编辑的那一个文件将会以方括号括起来；`:previous`回到前一个文件，`:wprevious`保存当前工作成果并回到前一个文件;`:last`移到最后一个文件;`:first`移到第一个文件；不过没有":wlast"或者":wfirst"这样的命令；也可以在":next"和":previous"命令前面使用一个命令计数`2next`

:set autowrite : 当你在不同文件之间转移时，你必需记住用":write"命令来存盘。否则就会得到一个错误消息。如果你确定自己每次都是要保存文件，就可以告诉Vim每当需要时就自动保存文件  
:set noautowrite  

当你有一个列表的文件要编辑时，Vim假设你要全部编辑它们。为防止你漏掉某些文件过早地退出，Vim会在你没有编辑过最后一个文件就想退出时给出一个错误信息，如果你确定要退出，只要再执行一次退出命令

CTRL+^: 在两个文件间快速切换,注意`CTRL+^`命令并不改变当前你在文件列表中的位置，只有命令":next"和":previous"才会引起此位置的变化

\`"：这个标记会带你到上次你离开该文件时光标所在的位置
\`.： 光标移至最后一次对文件做出改动处

小写字母命名的是全局标记，大写字母命名的是全局标记
假设我们正编辑"foo.txt"。到文件的半中间("50%")处设置一个名为F的标记(F意为foo): 50%mF
现在转而编辑"bar.txt"并在其最后一行设置一个名为B(B意为bar)的标记: GmB
现在你可以用"\`F"命令跳转到文件foo.txt的半中间。或者编辑另一个文件，"\`B"命令会再把你带回文件bar.txt的最后一行
要知道某个标记所代表的位置是什么，可以将该标记的名字作为"marks"命令的参数：` :marks F`
如果你删除了标记所在的行，同时也就等于删除了该标记

###### 不同文件间复制粘贴
使用寄存器a-z,`"`  
`"fas`: 把一个句子复制到名为f的寄存器中  
`"l3Y`: 把3个整行的内容放到寄存器l中  
`"fp`: 复制寄存器中的内容  

以只读的方式打开文件：`vim -R file`, 但任然可以强制保存`:w!`;想强制性地避免对文件进行修改，可以用命令`vim -M file`

:saveas move.c : 重命名

##### 分割窗口
:split : 该命令将屏幕分为上下两个窗口并将光标定位在上面的窗口中    
Ctrl-w w: 可以切换窗口  关闭除当前窗口外的所有其它窗口
:close : 关闭窗口  
:only : 关闭除当前窗口外的所有其它窗口  

:split two.c : 为另一个文件分隔出一个窗口
:new : 打开一个新窗口并开始编辑一个空的缓冲区  
可以重复使用":split"和":new"命令打开任何你喜欢的窗口数目

###### 调整窗口高度  
:3split alpha.c : ":split"命令还可以接受一个参数。如果指定了这个参数的话，它将会作为新打开窗口的高度  
Ctrl-w + ： 增加当前窗口高度；Ctrl-w -: 减小  
`{height}Ctrl-w _` : 将窗口高度指定为一个固定的高度  
让窗口达到它可能的最大高度，不指定命令记数直接使用`Ctrl-w _`

###### 垂直分割
:vsplit
:vnew :用于垂直分隔窗口并在其中打开一个新的空缓冲区  

###### 切换窗口  
因为你可以以水平和垂直方向任意分隔窗口，最终的窗口布局也会五花八门。置身于众多的窗口你需要在里面来去自如  
```
CTRL-W h 到左边的窗口
CTRL-W j 到下面的窗口
CTRL-W k 到上面的窗口
CTRL-W l 到右边的窗口
CTRL-W t 到顶部窗口
CTRL-W b 到底部窗口
```

###### 移动窗口  
如果你已经分隔出了几个窗口，但对它们的位置不满意。这时你需要一个命令来移动它们的相对位置
```
CTRL-W K 向下移动窗口
CTRL-W H 向左移动窗口
CTRL-W J 向下移动窗口
CTRL-W L 向右移动窗口
```
###### 针对所有窗口操作的命令  
:qall : quit all
:wall : write all
:wqall
:qall!  

`vim -o one.txt two.txt three.txt `使用"-o"选项可以让Vim为每一个文件打开一个窗口

vimdiff main.c~ main.c
折叠的栏位可以用使用"zo"来展开折叠，用"zc"再把它们折起

:vertical diffsplit main.c : 另 一 种 进 入diff模 式 的 办 法
:set noscrollbind : 设置两个窗口同步滚动  

要消除一个不同之处，你可以把高亮起来的文件从一个窗口移到另一个窗口去使用`dp`命令  
将光标移到右边的窗口，到"changed"插入的位置使用`do`命令  

###### 页签  
可能你已经注意到windows的窗口并不会互相交迭，如果挨个平铺下来你的显示屏幕很快就不够用了。解决之道在于页签  
:tabedit thatfile : 命令在一个窗口中打开"thatfile"，该窗口占据着整个的Vim显示区域  
gt : 切换至下一个页签，goto tab
gT : 切换至上一个页签  
ngt: 切换至下n个页签  
:tab help gt
"tabonly"命令会关闭除当前页签之外的所有页签，除非那些页签中有未保存的改动  

#### 大幅改动
##### 命令记录与回放
"."命令可以重复最近一次的编辑动作  
1. 使用`q{register}`命令开始，后续的动作将被记录进寄存器`{register}`中。寄存器名字a-z
2. 执行你要的操作
3. 再次按下`q`,结束对命令的记录
4. 通过`@{recording}`命令来执行刚刚记录下来的记录宏
```
将：
stdio.h
fcntl.h
unistd.h
stdlib.h
改为：
#include "stdio.h"
#include "fcntl.h"
#include "unistd.h"
#include "stdlib.h"

qa^i#inclue "$"jq
对其他三行执行@a或3@a, 如果已经执行过"@a"命令，下次也可执行"@@"
```

#### 寄存器
```
There are nine types of registers:                     
1. The unnamed register ""
2. 10 numbered registers "0 to "9
3. The small delete register "-
4. 26 named registers "a to "z or "A to "Z
5. four read-only registers ":, "., "% and "#
6. the expression register "=
7. The selection and drop registers "*, "+ and "~
8. The black hole register "_
9. Last search pattern register "/
```

##### 修改寄存器记录的内容
假设寄存器a中已经记录了一下命令。
```
"ap : 可以将寄存器中的内容打印出来，然后像普通文本一样编辑
"ay$ : 编辑完成之后再存回寄存器中
```

##### 灾难恢复
Vim会在你连续4秒不键入内容时跟磁盘同步一次 ，或者是连续键入了200个字符之后 。这可以通过'updatetime'和'updatecount'两个选项来控制
多数情况下恢复文件是简单的，如果你知道要恢复的文件名(当然也要保证你的硬盘还会转)，就可以在启动Vim时指定一个"-r"参数

#### 插入模式
##### 纠错
`<Del>`删除光标所在处(光标之后)的字符。
`ctrl-w`: 删除光标之前的单词
`ctrl-u`: 删除光标之前的所有内容，保留光标之后的字符并且保持原有的缩进。

##### 特殊键
特殊键用于定义一个不离开Insert模式进行操作的映射时很有用。可以避免你多键入额外的命令。
```
<Home> 到行首
<End> 到行尾
<PageUp> 向上滚屏
<PageDown> 向下滚屏
<C-Left> 向左移动一个word
<C-Right> 向右移动一个word
```

##### 显示匹配字符
`:set showmatch` : 键入"(example)"，一旦按下了)字符Vim就会把光标移到前面的(字符上，停留半秒钟，然后回到)字符之后的位置。
等待时间的长短可以由选项'matchtime'来控制， `:set matchtime=15`,时间单位是十分之一秒

##### 自动补全
`Ctrl-p/Ctrl-n`
可以用'complete'选项来定制Vim在补全word时所用的策略。
查找时会隐含地使用'ignorecase'选项。
`infercase`选项使搜索匹配的word时忽略剩余部分的大小写，但继续保留已键入的部分的大小写。

`Ctrl-y/Ctrl-e`: 重复上一行/下一行同列的字符

命令`CTRL-r {register}`可以在当前位置插入指定寄存器的内容。

###### 缩写
```
:iabbrev #b /****************************************
:iabbrev #e <Space>****************************************/
```
可以用":iab"代替完整的命令名":iabbrev"
`:abbreviations`命令可以列出当前定义的所有缩写：
```
:abbreviate
i #e ****************************************/
i #b /****************************************
i JB Jack Benny
i ad advertisement
! teh the
```
第一列中的"i"表明这是一个用于Insert模式下的缩写。这样的缩写只在Insert模式下有效。此外还可以有下面的字符代表该缩写发生作用的工作模式：
```
c 命令行模式 :cabbrev
! 同时适用于Insert模式和命令行模式 :abbreviate
```
`:unabbreviate`命令可以用于删除一个缩写。
`:abclear`移除所有的缩写

###### Normal模式命令
使用`TRL-o {command}`可以在Insert模式下执行任何一个Normal模式下的命令。

##### 格式化文本
设置了`extwidth`项， Vim就会自动换行。
```
:set textwidth=70
```
`wrap`选项使Vim能显示需要折行的过长的行，但这是另一回事，它只是为了显示的需要，并不会在文件中实际插入一个换行符。

##### 重复操作
"gv"命令可以再次选定上次选择的Visual区域。这使你可以对同样的文本对象施以其它的操作。
###### 对多个文件做改动
如果你想把好几个C文件中名为"x_nt"的变量都改为"x_ounter"。这就要动到多个文件。
先把所有要改的文件放到参数列表上：
```
:args *.c
```
对所有的文件都进行同一个替换操作：
```
:argdo %s/\<x_cnt\>/x_counter/ge | update
```
":argdo"命令以另一个命令为参数。该命令将对所有待编辑的文件都执行一次。
替换操作的标志"g"使得每行中的全部"x_nt"都被替换。标志"e"则用 于 避 免 某 些 文 件 中 一 个"x_nt"都 找 不 到 时 的 错 误 消 息 。 否 则 的
话":argdo"命令遇到这些错误就会终止整个操作。
"|"用来分隔两个命令。后面的"update"命令会在文件有改变时进行保存。

##### 搜索
:set ignorecase : 忽略大小写
:set ignorecase smartcase ：如果你要搜索的内容中至少包括一个大写字母，整个搜索就会是大小写敏感的。这样设计你就不必总是输入大写字符了，你想要进行大小写敏感的搜索时准确键入就行了。

###### 正则表达式内部的大小写
如果你只想对搜索模式的一部分应用大小写不敏感的策略，可以在它前面加上一个"\c"。使用"\C"会使大小写敏感。而且这两个前辍的优先级高于'ignorecase'和'smartcase'选项的设定 ，使用"\c"或"\C"时Vim不会考虑这两个选项的值是什么。

###### 循环搜索
默认情况下，一个向前的搜索会从当前光标开始，直到找到目标或达到文件尾。如果到了文件尾还没有找到匹配的字符串，它就会从文件开头继续查找。
要关闭越过文件头尾的循环搜索，可以使用下面的命令：`:set nowrapscan`

##### 偏移
默认情况下，搜索到一个目标后光标会停留在目标字符串的第一个字符上。你也可以告诉Vim此时要如何放置光标。对于向前搜索命令"/"来说，指定一个偏移可以通过在模式最后再加上一个/符号，紧接着指定你要的偏移。
```
/default/2
```
如果指定的偏移是一个简单的数字，光标就会被简单地置于目标行其下第N行的开头。偏移可以是正的也可以是负的。如果是正的，光标会在找到目标行后向前移动，反之向后移。
```
/const/e
/const/e+1
/const/b+2
```
"e"指示光标在找到目标串之后以它的结尾作为移动的起始处。它会把光标置于目标字符串的最后一个字符
如果偏移指示符是以"b"开始的，则光标移动到目标字符串的开头。

要重复前一个搜索但应用不同的偏移，可以空出模式部分：
```
/that
//e
```
反向搜索：
```
?const?e-2
```
###### 多次匹配
`*` : 重复前面字符0次或多次
`\+` : 重复前面字符一次或多次
要匹配一个可有可无的项，使用"\="

###### 指定重复次数
`\{n,m}`其前的项会被匹配"n"次到"m"次
所有的重复项都是"贪婪"地匹配所能找到的字符。要尽可能少次数地重复一个项，使用`\{-n,m}`。

###### 或与非
"或"操作符是"\|" `/foo\|bar`
"\&"。它要求两个并列的选项同时被被匹配到
[^]

###### 字符范围
/[0-9a-z]

##### C程序
##### tags
tag是什么？一个位置。记录了关于一个标识符在哪里被定义的信息。比如C或C++程序中的一个函数定义。这种tag聚集在一起被放入一个tags文件。这个文件可以让Vim能够从任何位置起跳达到tag所指示的位置--标识符被定义的位置。
shell命令`ctags *.c`可以为当前目录下的所有C程序文件生成对应的tags文件,"ctags"是一个独立的程序。绝大多数Unix系统上都会预装这个程序
`CTRL-]`命令会取当前光标下的word作为tag的名字并直接跳转。
 `CTRL-t`命令会跳到你前一次的tag处。`CTRL-t`也可以带一个前辍。
":tags"命令会列出现在你就已经到过哪些tag



